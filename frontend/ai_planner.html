<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent Command Center</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Local CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="page-container">
    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <div class="logo-text gradient-text">
                <i class="bi bi-cpu-fill"></i>AI Agent
            </div>
            <button id="sidebar-close" class="btn btn-ghost" title="Close Sidebar">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>

        <div class="glass-card">
            <div class="glass-card-body">
                <label for="goal-input" class="form-label fw-semibold mb-3">
                    <i class="bi bi-bullseye me-2"></i>Your Goal
                </label>
                <textarea id="goal-input" class="form-control mb-3" rows="4" placeholder="What would you like the AI to accomplish?"></textarea>
                <button id="start-button" class="btn btn-gradient w-100">
                    <i class="bi bi-rocket-takeoff me-2"></i>Execute Mission
                </button>
            </div>
        </div>

        <div class="glass-card">
            <div class="glass-card-header">
                <h6 class="fw-semibold mb-0"><i class="bi bi-activity me-2"></i>Status</h6>
            </div>
            <div class="glass-card-body">
                <div id="status-indicator">
                    <!-- Status badge will be rendered here by JS -->
                </div>
                <div id="connection-error" class="alert alert-danger d-none mt-3">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <strong>Connection Failed</strong><br>
                    <small>Please ensure the backend server is running.</small>
                </div>
            </div>
        </div>

        <div class="glass-card">
            <div class="glass-card-header">
                <h6 class="fw-semibold mb-0"><i class="bi bi-info-circle me-2"></i>About</h6>
            </div>
            <div class="glass-card-body">
                <p class="text-muted small mb-0">
                    This AI agent system clarifies goals, creates plans, executes tasks, and synthesizes reports.
                </p>
            </div>
        </div>

        <div class="glass-card">
            <div class="glass-card-header d-flex justify-content-between align-items-center">
                <h6 class="fw-semibold mb-0"><i class="bi bi-collection me-2"></i>Active Missions</h6>
                <button id="refresh-missions-btn" class="btn btn-sm btn-ghost" title="Refresh Missions">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>
            <div class="glass-card-body p-0">
                <ul id="active-missions-list" class="list-group list-group-flush">
                    <!-- Active missions will be loaded here by JS -->
                    <li class="list-group-item bg-transparent text-muted small">Loading missions...</li>
                </ul>
            </div>
        </div>

        <div class="glass-card">
            <div class="glass-card-header">
                <h6 class="fw-semibold mb-0"><i class="bi bi-plus-circle me-2"></i>Add New Idea</h6>
            </div>
            <div class="glass-card-body">
                <form id="add-idea-form">
                    <div class="input-group">
                        <input type="text" id="new-idea-input" class="form-control" placeholder="Enter a new idea...">
                        <button class="btn btn-outline-primary" type="submit" id="add-idea-btn">Add</button>
                    </div>
                </form>
            </div>
        </div>

        <div class="glass-card">
            <div class="glass-card-header">
                <h6 class="fw-semibold mb-0"><i class="bi bi-lightbulb me-2"></i>Previous Ideas</h6>
            </div>
            <div class="glass-card-body p-0">
                <ul id="previous-ideas-list" class="list-group list-group-flush">
                    <!-- Previous ideas will be loaded here by JS -->
                    <li class="list-group-item bg-transparent text-muted small">Loading ideas...</li>
                </ul>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="main-header">
            <button id="sidebar-toggle" class="btn btn-ghost" title="Toggle AI Agent">
                <i class="bi bi-robot"></i>
            </button>
            <h1 class="main-title">Command Center</h1>
        </div>

        <!-- Graph Visualizer -->
        <div class="glass-card mb-4">
            <div class="glass-card-header">
                <h5 class="fw-bold mb-0"><i class="bi bi-diagram-3-fill me-2"></i>Execution Pipeline</h5>
            </div>
            <div class="glass-card-body">
                <div class="graph-container">
                    <div class="graph-visualizer">
                        <div class="graph-node" data-node="clarify_goal"><i class="bi bi-search"></i>Clarify Goal</div>
                        <div class="connector" data-connector="1"></div>
                        <div class="graph-node" data-node="create_plan"><i class="bi bi-list-check"></i>Create Plan</div>
                        <div class="connector" data-connector="2"></div>
                        <div class="graph-node" data-node="execute_step"><i class="bi bi-gear-wide-connected"></i>Execute</div>
                        <div class="connector" data-connector="3"></div>
                        <div class="graph-node" data-node="synthesize_report"><i class="bi bi-file-earmark-text"></i>Report</div>
                    </div>
                    <div class="graph-visualizer mt-3 justify-content-center" style="opacity: 0.7;">
                        <div class="graph-node" data-node="handle_vague_goal">
                            <i class="bi bi-exclamation-triangle"></i>Handle Error
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logs & Report -->
        <div class="glass-card">
            <div class="glass-card-header">
                <h5 class="fw-bold mb-0"><i class="bi bi-terminal me-2"></i>Execution Details</h5>
            </div>
            <div class="glass-card-body">
                <ul class="nav nav-tabs mb-3" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="log-tab" data-bs-toggle="tab" data-bs-target="#log-pane" type="button">
                            <i class="bi bi-activity me-2"></i>Live Log
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="report-tab" data-bs-toggle="tab" data-bs-target="#report-pane" type="button">
                            <i class="bi bi-file-earmark-bar-graph me-2"></i>Final Report
                        </button>
                    </li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane fade show active" id="log-pane" role="tabpanel">
                        <div class="log-container" id="log-container">
                            <div class="empty-state" id="log-placeholder">
                                <i class="bi bi-terminal"></i>
                                <span>Execution logs will appear here...</span>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="report-pane" role="tabpanel">
                        <div class="p-3" id="final-report">
                            <!-- Final report will be rendered here by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Edit Idea Modal -->
    <div class="modal fade" id="edit-idea-modal" tabindex="-1" aria-labelledby="editIdeaModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content glass-card">
                <div class="modal-header">
                    <h5 class="modal-title" id="editIdeaModalLabel">Edit Idea</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-idea-form">
                        <input type="hidden" id="edit-idea-id">
                        <textarea id="edit-idea-input" class="form-control" rows="4"></textarea>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="save-idea-btn">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Socket.IO Client -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Local JS -->
    <script src="script.js"></script>
</body>
</html>